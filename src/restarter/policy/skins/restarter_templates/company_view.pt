<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
<body>

<metal:content-core fill-slot="content-core">

      <metal:body_macro metal:define-macro="body">

        <div id="companyBody" tal:define="restarter context/@@config_restarter;">
          <div class="companyRec">
            <h2>
              <metal:field use-macro="python:context.widget('ragione_sociale', mode='view')"></metal:field> 
            </h2>

            <div class="comAddressWrapper">
              <metal:field use-macro="python:context.widget('address', mode='view')"></metal:field> - 
              <metal:field use-macro="python:context.widget('cap', mode='view')"></metal:field>
              <strong><metal:field use-macro="python:context.widget('city', mode='view')"></metal:field>
              (<metal:field use-macro="python:context.widget('province', mode='view')"></metal:field>)</strong>
            </div>
            <div class="comNumbers">
              <p class="comEmail"><span class="labelTxt">E-mail:</span> <metal:field use-macro="python:context.widget('email', mode='view')"></metal:field></p>
              <p class="comCell"><span class="labelTxt">Mobile:</span> <metal:field use-macro="python:context.widget('cellphone', mode='view')"></metal:field></p>
              <p class="comWeb"><span class="labelTxt">Web:</span> <metal:field use-macro="python:context.widget('website', mode='view')"></metal:field></p>
            </div>
            <p class="comPI"><span class="labelTxt">P.Iva/C.F.:</span> <metal:field use-macro="python:context.widget('piva', mode='view')"></metal:field></p>
            <p class="companySector"><span class="labelTxt">Settore merceologico:</span> <metal:field use-macro="python:context.widget('company_sectore', mode='view')"></metal:field></p>
          </div>

        </div>

<!-- ##### mettere codice per i primi tre prodotti dell'azienda 
            non mostrare questo blocco se l'azienda non ha prodotti pubblicati -->

        <dl id="companyProductsList" class="portlet faCollectionPortlet productsPortlet">
            <dt class="portletHeader">
<!-- #### il link more si deve vedere solo se i prodotti sono piu' di 3 -->
                <tal:more>
                  <a class="linkMore">
                     Vedi Tutti
                  </a>
                </tal:more>

                <span class="tile">
                    Ultimi prodotti inseriti dall'azienda
                </span>
            </dt>
<!-- #########
          <tal:events tal:repeat="obj query_results"
            <dd class="portletItem faCollectionPortletItem">

              <div class="faCollectionImg">
                <a href="#">
                  <img src="" alt=""               
                       tal:attributes="src string:${obj/getURL}/leadImage_mini;
                                       alt obj/Description;"/>
                </a>
              </div>
              <p class="itemData"  tal:on-error="string:"
                 tal:content="python:toLocalizedTime(obj.Date)">02 Giugno 2012</p>

              <h3 class="faCollectionTitle">
                <a href="#" 
                   tal:content="python: restarter.safe_truncate(obj.Title, 50)"
                   tal:attributes="href obj/getURL;">Cum sociis natoque penatibus et magnis dis parturient</a>
              </h3>
              <p class="faCollectionDesc" tal:content="python: restarter.safe_truncate(obj.Description, 100)">
                Descrizione prodotto
              </p>
              <p class="productPrice"><span class="euro"  tal:on-error="string:" tal:content="obj/product_price">110.00</span> euro</p>
              <p class="btnLink"><a class="btn" href="#" tal:attributes="href obj/getURL;">Dettagli</a></p>

              <div class="visualClear"></div>
            </dd>
          </tal:events>
###### -->
          </dl>
        <div class="visualClear"></div>

<!-- ##### idem... queste sono le demands della company -->
         <dl id="companyDemandsList" class="portlet faCollectionPortlet productsPortlet offersPortlet">

            <dt class="portletHeader">
<!-- #### il link more si deve vedere solo se le demands sono piu' di 3 -->
                <tal:more>
                  <a class="linkMore">
                     Vedi Tutte
                  </a>
                </tal:more>

                <span class="tile">
                    Richieste dell'azienda
                </span>
            </dt>
<!--              
              <tal:events tal:repeat="obj query_results">
              <dd class="portletItem faCollectionPortletItem"
                  tal:define="oddrow repeat/obj/odd;
                              item_path obj/getPath;"
                  tal:attributes="class python:oddrow and 'portletItem even faCollectionPortletItem' or 'portletItem odd faCollectionPortletItem'">


                <p class="itemData" 
                   tal:condition="view/data/show_dates"
                   tal:on-error="string:"
                   tal:content="python:toLocalizedTime(obj.Date)">02 Giugno 2012</p>
                <h3 class="faCollectionTitle">
                  <a href="#" 
                      tal:content="python: restarter.safe_truncate(obj.Title, 50)"
                     tal:attributes="href obj/getURL;">Cum sociis natoque penatibus et magnis dis parturient</a>
                </h3>
                <p class="faCollectionDesc" tal:content="python: restarter.safe_truncate(obj.Description, 150)">
                  Descrizione prodotto
                </p>
                <p class="btnLink"><a class="btn" href="#" tal:attributes="href obj/getURL;">Dettagli</a></p>

                <div class="visualClear"></div>
              </dd>
              </tal:events>
-->

          </dl>

          <div class="comMap visualClear">
            <img src="" tal:define="address context/gmap_address"
                 tal:attributes="src string:http://maps.googleapis.com/maps/api/staticmap?center=${address}&zoom=12&size=580x200&maptype=roadmap&markers=color:red%7C${address}&sensor=false">
          </div>

      </metal:body_macro>

      <metal:folderlisting_macro metal:define-macro="folderlisting"/>


</metal:content-core>

</body>
</html>

