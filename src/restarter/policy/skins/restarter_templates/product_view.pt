<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone"
      lang="en">

<body>

<metal:content-core fill-slot="content-core">

  <metal:body_macro metal:define-macro="body">
      <div id="productBody">
            <div class="prodField prodCategoria">
                  <span class="lab">Categoria: </span>
                  <span class="val">
                        <metal:field use-macro="python:context.widget('category', mode='view')"></metal:field>
                  </span>
            </div>
            <div class="prodField prodCondition">
                  <span class="lab">Condizione del prodotto: </span>
                  <span class="val">
                        <metal:field use-macro="python:context.widget('product_condition', mode='view')"></metal:field>
                  </span>
            </div>

            <div class="prodField prodShip">
                  <span class="lab">Consegna/spedizione: </span>
                  <span class="val">
                        <metal:field use-macro="python:context.widget('shipment', mode='view')"></metal:field>
                  </span>
            </div>

            <div class="prodField prodWaranty">
                  <span class="lab">Garanzia: </span>
                  <span class="val">
                        <metal:field use-macro="python:context.widget('waranty', mode='view')"></metal:field>
                  </span>
            </div>

            <div class="prodPriceGroup">
                  <div class="prodField prodQty">
                        <span class="lab">Quantità: </span>
                        <span class="val">
                              <metal:field use-macro="python:context.widget('quantity', mode='view')"></metal:field>
                        </span>
                  </div>
                  
                  <div class="prodField prodPrice">
                        <span class="lab">Prezzo: </span>
                        <span class="val">
                              <span class="numberPrice">
                                    <metal:field use-macro="python:context.widget('price', mode='view')"></metal:field> &euro;
                              </span>
                              <span class="unitSep">/</span>
                              <metal:field use-macro="python:context.widget('unit', mode='view')"></metal:field>            
                        </span>
                  </div>

                  <div class="prodBuy" tal:condition="context/showNewOrderButton">
                        <p class="btnLink">
                        <a class="btn" href="" tal:attributes="href string:${context/absolute_url}/createObject?type_name=Order">Acquista</a>
                        </p>
                  </div>
                  <div class="visualClear"></div>
            </div>
            
      </div>
      <div id="product-counter" tal:define="stats context/portal_stats/getStats" tal:on-error="string:">
          <div class="counterPrenot">
            <span class="labelTxt">Valore delle unità prenotate:</span>
            <span class="val"><tal:stats replace="python: stats['products'][context.UID()].get('new',0)"/> &euro;</span>
          </div>
          <div class="counterSell">
            <span class="labelTxt">Valore delle unità vendute:</span>
            <span class="val"><tal:stats replace="python: stats['products'][context.UID()].get('accepted',0)"/> &euro;</span>
          </div>
          <div class="visualClear"></div>
      </div>
      <div id="product-offers">
            <h4>Offerte in corso e concluse per questo prodotto</h4>
<!-- ############ mettere condiione: da mostrare se non ci sono offerte -->            
<!--            <p class="noOffers">
                  Questo prodotto non ha ancora ricevuto offerte di acquisto.
            </p>
            <p class="noOffers">
                  <a class="btn" href="" tal:attributes="href string:${context/absolute_url}/createObject?type_name=Order">Fai la prima offerta!</a>
            </p> -->
<!-- ######## fine "non ci sono offerte" -->
<!-- #### se invece ci sono offerte... -->
            <ul class="listOffers">
                  <li>
                        <a href="#" class="offerTitle">Titolo dell'offerta</a>  <span class="offerAuthor">di Pinco Pallino</span>
                        <span class="offerStatus state-new">New</span> <!-- ### ci vuole la classe css corrispondente allo stato -->
                  </li>
                  <li>
                        <a href="#" class="offerTitle">Titolo dell'offerta</a>  <span class="offerAuthor">di Pinco Pallino</span>
                        <span class="offerStatus state-accepted">Accettata</span> <!-- ### ci vuole la classe css corrispondente allo stato -->
                  </li>
            </ul>
      </div>
      </metal:body_macro>


      <metal:folderlisting_macro metal:define-macro="folderlisting">

      </metal:folderlisting_macro>


</metal:content-core>

</body>
</html>
